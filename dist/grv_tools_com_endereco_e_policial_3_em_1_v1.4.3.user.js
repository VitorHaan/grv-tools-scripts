// ==UserScript==
// @name         GRV Tools com Endereço e Policial 3 em 1 v1.4.3
// @namespace    vitor.grv.tools
// @version      1.4.3
// @description  LISTA (canônica) + ENDEREÇO (Apreensão/Remoção/Ambos – opcional) + POLICIAL (opcional, via DETALHE). Situação por status, datas sem .000000. Exporta XLSX/TSV. UI aprovada (padrão: filtro "No pátio"; páginas 1→5; sem atalhos). Força 100 por página, aplica filtro de Situação JÁ NA API e coleta exatamente N×100 mantidos.
// @match        https://intranet.consorciorioparkingcarioca.com/*
// @run-at       document-start
// @grant        none
// @updateURL    https://raw.githubusercontent.com/VitorHaan/grv-tools-scripts/main/dist/grv_tools_com_endereco_e_policial_3_em_1_v1.4.3.user.js
// @downloadURL  https://raw.githubusercontent.com/VitorHaan/grv-tools-scripts/main/dist/grv_tools_com_endereco_e_policial_3_em_1_v1.4.3.user.js
// ==/UserScript==

(function(){"use strict";
  // Ofuscado com empacotamento Base64 (acento-safe).
  const b="LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgR1JWIFRvb2xzIOKAlCAzIGVtIDEgKExpc3RhICsgRW5kZXJlw6dvICsgUG9saWNpYWwpCiAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgIOKWuiBDSEFOR0VMT0cKICAgICB2MS40LjAKICAgICAgIOKAoiBGaWx0cm8gcG9yIFNpdHVhw6fDo28gYXBsaWNhZG8gTk8gU0VSVklET1IgKEFQSSk6IHNlbXByZSBxdWUgbyBmaWx0cm8gZG8KICAgICAgICAgc2NyaXB0IGZvciBudW3DqXJpY28sIG8gcmVxdWVzdCBkYSBMSVNUQSByZWNlYmUgJnN0YXR1cz08Y8OzZGlnbz4uIFBhcmEKICAgICAgICAg4oCcUmV0aXJhZG9zIChxdWFscXVlcinigJ0sIGEgcXVlcnkgZW52aWEgdsOhcmlvcyBzdGF0dXM9ICgxMDAsMTAxLDEwMiwxMDQsCiAgICAgICAgIDEwNSwxMDcsMTA4LDEwOSwxMTApLiBQYXJhIOKAnFRvZG9z4oCdLCBuw6NvIGVudmlhIHN0YXR1cy4KICAgICAgIOKAoiBDb2xldGEgcG9yIG1ldGEgZGUgbWFudGlkb3M6IHNlIEZpbT01LCBvIGNvbGV0b3IgcGFnaW5hIGF0w6kganVudGFyIDXDlzEwMAogICAgICAgICBpdGVucyBxdWUgcGFzc2FtIG5vIGZpbHRybyBkbyBzY3JpcHQgKG91IGF0w6kgYSBsaXN0YSB6ZXJhciksIGVtIHZleiBkZQogICAgICAgICBwYXJhciBlbSA1IHDDoWdpbmFzIGNydWFzLgogICAgICAg4oCiIE1hbnRpZG86IGZvcsOnYSAxMDAgcG9yIHDDoWdpbmEgKGxpbWl0L3BlclBhZ2UvcGFnZVNpemUvc2l6ZSA9IDEwMCkuCiAgICAgICDigKIgUGFkcsOjbyBkZSBpbnRlcnZhbG8gbmEgVUk6IEluw61jaW89MSwgRmltPTUgKHZvY8OqIHDDtWUgMCBxdWFuZG8gcXVpc2VyCiAgICAgICAgIHZhcnJlciBhdMOpIGEgcHJpbWVpcmEgcMOhZ2luYSB2YXppYSkuCgogICAgIHYxLjMuMAogICAgICAg4oCiIChvYnNvbGV0bykgbWV0YSBkZSBtYW50aWRvcyBleGlzdGlhLCBtYXMgYWluZGEgaGF2aWEgdW0gbGltaXRlIG9jdWx0byBkZQogICAgICAgICDigJxww6FnaW5hcyBjcnVhc+KAnS4gUmVtb3ZpZG8gbmVzdGEgdmVyc8Ojby4KCiAgICAgdjEuMi4wCiAgICAgICDigKIgVFNWIGVzdMOhdmVsIChzYW5pdGl6YcOnw6NvIFxuLCBcdCwgTkJTUCkuCiAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogICDimpbvuI8gU2l0dWHDp8OjbyDigJQgcmVncmEgY2Fuw7RuaWNhIChTRU0gVEVYVE8gZGEgVUkhKQogICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICDigKIgRm9udGUgZGEgdmVyZGFkZTogc3RhdHVzIG51bcOpcmljbyBkYSBMSVNUQS4KICAg4oCiIE1hcGE6CiAgICAgICAgMDogIlBlbmRlbnRlIgogICAgICAgIDE6ICJObyBww6F0aW8iCiAgICAgICAgMjogIkVtIGxlaWzDo28iCiAgICAgICAgNDogIkNsb25lIgogICAgICAgIDU6ICJFeGNsdWlyIgogICAgICAgIDY6ICJGcnVzdHJhZG8iCiAgICAgICAgMTAwOiAiUmV0aXJhZG8gcGVsbyBwcm9wcmlldMOhcmlvIgogICAgICAgIDEwMTogIlJldGlyYWRvIHBvciBsZWlsw6NvIgogICAgICAgIDEwMjogIlJldGlyYWRvIHBvciBkZWNpc8OjbyBqdWRpY2lhbCIKICAgICAgICAxMDQ6ICJSZXRpcmFkbyBwZWxvIHJlcHJlc2VudGFudGUgbGVnYWwiCiAgICAgICAgMTA1OiAiUmV0aXJhZG8gcG9yIHByZW5zYSIKICAgICAgICAxMDc6ICJSZXRpcmFkbyBwb3IgbGVpbMOjbyBleHRlcm5vIgogICAgICAgIDEwODogIlJldGlyYWRvIHBvciByb3Viby9mdXJ0byIKICAgICAgICAxMDk6ICJSZXRpcmFkbyBwb3IgbGVpbMOjbyBwZWxvIHJlcHJlc2VudGFudGUgbGVnYWwiCiAgICAgICAgMTEwOiAiUmV0aXJhZG8gcGVsbyByZXByZXNlbnRhbnRlIGxlZ2FsIC0gw5NiaXRvIgoKICAg8J+VkiBEYXRhcyDigJQgcmVtb3ZlciDigJwuMDAwMDAw4oCdIGUgZm9ybWF0YXIgZGQvTU0veXl5eSBISDptbQogICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAg8J+nrSBQb2xpY2lhbCDigJQgREVUQUxIRSBwb3IgaWQgKG51bmNhIHBvciBudW1lcm8pCiAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICDwn6epIEVuZGVyZcOnbyDigJQgTElTVEEgb25seSAoc2VtIGRldGFsaGUpCiAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICDwn5OLIFRTViDigJQgc2FuaXRpemHDp8OjbyBwYXJhIGNvbGFnZW0gcGVyZmVpdGEKICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KPT09PT09...(cortado)";
  const bin = (typeof atob === "function") ? atob(b) : (typeof Buffer !== "undefined" ? Buffer.from(b,"base64").toString("binary") : b);
  let src;
  try { src = new TextDecoder("utf-8").decode(Uint8Array.from(bin, c => c.charCodeAt(0))); }
  catch(e) { try { src = decodeURIComponent(escape(bin)); } catch(_) { src = bin; } }
  (0, eval)(src);
})();
