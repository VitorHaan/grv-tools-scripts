// ==UserScript==
// @name         GRV Tools com Endereço e Policial 3 em 1 v1.4.3
// @namespace    vitor.grv.tools
// @version      1.4.3
// @description  LISTA (canônica) + ENDEREÇO (Apreensão/Remoção/Ambos – opcional) + POLICIAL (opcional, via DETALHE). Situação por status, datas sem .000000. Exporta XLSX/TSV. UI aprovada (padrão: filtro "No pátio"; páginas 1→5; sem atalhos). Força 100 por página, aplica filtro de Situação JÁ NA API e coleta exatamente N×100 mantidos.
// @match        https://intranet.consorciorioparkingcarioca.com/*
// @run-at       document-start
// @grant        none
// @updateURL    https://raw.githubusercontent.com/VitorHaan/grv-tools-scripts/main/dist/grv_tools_com_endereco_e_policial_3_em_1_v1.4.3.user.js
// @downloadURL  https://raw.githubusercontent.com/VitorHaan/grv-tools-scripts/main/dist/grv_tools_com_endereco_e_policial_3_em_1_v1.4.3.user.js
// ==/UserScript==

(function(){"use strict";
  // Ofuscado com empacotamento Base64 (acento-safe).
  const b="KGZ1bmN0aW9uICgpIHsKICAidXNlIHN0cmljdCI7CgogIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gRVNUQURPID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBjb25zdCBMU19CRUFSRVJfS0VZID0gImdydnRvb2xzX2xhc3RfYmVhcmVyIjsKCiAgY29uc3QgU1RBVEUgPSB7CiAgICBhdXRoSGVhZGVyOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMU19CRUFSRVJfS0VZKSB8fCAiIiwKICAgIGxpc3RCYXNlOiAiIiwgICAgICAgICAgICAgLy8gVVJMIGJhc2UgZGEgTElTVEEgKHNlbSBwYWdlOyBNRVNNQSBvcmlnZW0gcGFyYSBvIERFVEFMSEUpCiAgICBiYXNlTG9nZ2VkT25jZTogZmFsc2UsICAgIC8vIGxvZyDigJzinJMgQmFzZS4uLuKAnSBhcGVuYXMgMXgvIHNlc3PDo28KICAgIHJvd3NBT0E6IG51bGwsICAgICAgICAgICAgLy8gbWF0cml6IHBhcmEgZXhwb3J0YcOnw6NvCiAgfTsKCiAgLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBNQVBBUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCiAgY29uc3QgU0lUVUFDQU9fTUFQID0gewogICAgMDogICAiUGVuZGVudGUiLAogICAgMTogICAiTm8gcMOhdGlvIiwKICAgIDI6ICAgIkVtIGxlaWzDo28iLAogICAgNDogICAiQ2xvbmUiLAogICAgNTogICAiRXhjbHVpciIsCiAgICA2OiAgICJGcnVzdHJhZG8iLAogICAgMTAwOiAiUmV0aXJhZG8gcGVsbyBwcm9wcmlldMOhcmlvIiwKICAgIDEwMTogIlJldGlyYWRvIHBvciBsZWlsw6NvIiwKICAgIDEwMjogIlJldGlyYWRvIHBvciBkZWNpc8OjbyBqdWRpY2lhbCIsCiAgICAxMDQ6ICJSZXRpcmFkbyBwZWxvIHJlcHJlc2VudGFudGUgbGVnYWwiLAogICAgMTA1OiAiUmV0aXJhZG8gcG9yIHByZW5zYSIsCiAgICAxMDc6ICJSZXRpcmFkbyBwb3IgbGVpbMOjbyBleHRlcm5vIiwKICAgIDEwODogIlJldGlyYWRvIHBvciByb3Viby9mdXJ0byIsCiAgICAxMDk6ICJSZXRpcmFkbyBwb3IgbGVpbMOjbyBwZWxvIHJlcHJlc2VudGFudGUgbGVnYWwiLAogICAgMTEwOiAiUmV0aXJhZG8gcGVsbyByZXByZXNlbnRhbnRlIGxlZ2FsIC0gw5NiaXRvIiwKICB9OwogIGNvbnN0IFJFVF9TVEFUVVMgPSBuZXcgU2V0KFsxMDAsMTAxLDEwMiwxMDQsMTA1LDEwNywxMDgsMTA5LDExMF0pOwoKICAvLyBPcMOnw7VlcyBkbyBmaWx0cm8gKHZhbG9yIGludGVybm8g4oaSIGxhYmVsIGV4aWJpZGEpCiAgY29uc3QgRklMVEVSX09QVElPTlMgPSBbCiAgICBbImFsbCIsICAiVG9kb3MiXSwKICAgIFsiMSIsICAgICJObyBww6F0aW8iXSwgICAgIC8vIHBhZHLDo28gZGEgVUkKICAgIFsiMCIsICAgICJQZW5kZW50ZSJdLAogICAgWyIyIiwgICAgIkVtIGxlaWzDo28iXSwKICAgIFsiNCIsICAgICJDbG9uZSJdLAogICAgWyI1IiwgICAgIkV4Y2x1aXIiXSwKICAgIFsiNiIsICAgICJGcnVzdHJhZG8iXSwKICAgIFsicmV0IiwgICJSZXRpcmFkb3MgKHF1YWxxdWVyKSJdLAogICAgWyIxMDAiLCAgIlJldGlyYWRvIHBlbG8gcHJvcHJpZXTDoXJpbyJdLAogICAgWyIxMDEiLCAgIlJldGlyYWRvIHBvciBsZWlsw6NvIl0sCiAgICBbIjEwMiIsICAiUmV0aXJhZG8gcG9yIGRlY2lzw6NvIGp1ZGljaWFsIl0sCiAgICBbIjEwNCIsICAiUmV0aXJhZG8gcGVsbyByZXByZXNlbnRhbnRlIGxlZ2FsIl0sCiAgICBbIjEwNSIsICAiUmV0aXJhZG8gcG9yIHByZW5zYSJdLAogICAgWyIxMDciLCAgIlJldGlyYWRvIHBvciBsZWlsw6NvIGV4dGVybm8iXSwKICAgIFsiMTA4IiwgICJSZXRpcmFkbyBwb3Igcm91Ym8vZnVydG8iXSwKICAgIFsiMTA5IiwgICJSZXRpcmFkbyBwb3IgbGVpbMOjbyBwZWxvIHJlcHJlc2VudGFudGUgbGVnYWwiXSwKICAgIFsiMTEwIiwgICJSZXRpcmFkbyBwZWxvIHJlcHJlc2VudGFudGUgbGVnYWwgLSDDk2JpdG8iXSwKICBdOwoKICAvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IFVUSUxTID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBjb25zdCBwMiA9IChuKSA9PiBTdHJpbmcobikucGFkU3RhcnQoMiwgIjAiKTsKICBjb25zdCB0cyA9ICgpID0+IHsgY29uc3QgZD1uZXcgRGF0ZSgpOyByZXR1cm4gYCR7ZC5nZXRGdWxsWWVhcigpfS0ke3AyKGQuZ2V0TW9udGgoKSsxKX0tJHtwMihkLmdldERhdGUoKSl9XyR7cDIoZC5nZXRIb3VycygpKX1oLiR7cDIoZC5nZXRNaW51dGVzKCkpfW1pbi4ke3AyKGQuZ2V0U2Vjb25kcygpKX1zZWdgOyB9OwogIGNvbnN0IHNsZWVwID0gKG1zKSA9PiBuZXcgUHJvbWlzZShyPT5zZXRUaW1lb3V0KHIsbXMpKTsKICBjb25zdCBzYWZlICA9ICh2KSA9PiAodj09bnVsbCB8fCB2PT09IiIpID8gIi0tLS0tIiA6IFN0cmluZyh2KTsKICBjb25zdCBtYXNrICA9IChzLG1heD01NCk9PiAhcyA/ICLigJQiIDogKHMubGVuZ3RoPm1heCA/IChzLnNsaWNlKDAsTWF0aC5mbG9vcihtYXgvMiktMSkrIuKApiIrcy5zbGljZSgtTWF0aC5mbG9vcihtYXgvMikpKSA6IHMpOwogIGNvbnN0IGxvZyAgID0gKG0pPT57IHRyeXsgaWYobG9nRWwpeyBsb2dFbC52YWx1ZSArPSBtICsgIlxuIjsgbG9nRWwuc2Nyb2xsVG9wID0gbG9nRWwuc2Nyb2xsSGVpZ2h0OyB9IH1jYXRjaHt9IH07CgogIGZ1bmN0aW9uIHVwZGF0ZUJhZGdlcygpewogICAgdHJ5ewogICAgICBiYWRnZVRvay50ZXh0Q29udGVudCAgPSAiVG9rZW46ICIgKyBtYXNrKFNUQVRFLmF1dGhIZWFkZXIsIDQ0KTsKICAgICAgYmFkZ2VUb2sudGl0bGUgICAgICAgID0gU1RBVEUuYXV0aEhlYWRlciB8fCAi4oCUIjsKICAgICAgYmFkZ2VCYXNlLnRleHRDb250ZW50ID0gIkJhc2U6ICIgKyBtYXNrKFNUQVRFLmxpc3RCYXNlLCA2MCk7CiAgICAgIGJhZGdlQmFzZS50aXRsZSAgICAgICA9IFNUQVRFLmxpc3RCYXNlIHx8ICLigJQiOwogICAgfWNhdGNoe30KICB9CgogIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09IERFVEVDw4fDg08gREEgTElTVEEgPT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBmdW5jdGlvbiBpc0xpc3QodSl7CiAgICB0cnl7IGNvbnN0IHVybD1uZXcgVVJMKHUsbG9jYXRpb24ub3JpZ2luKTsgcmV0dXJuIC9eXC9hcGlcL2dydlwvPyQvLnRlc3QodXJsLnBhdGhuYW1lKTsgfWNhdGNoeyByZXR1cm4gZmFsc2U7IH0KICB9CiAgZnVuY3Rpb24gbm9ybWFsaXplQmFzZSh1KXsKICAgIHRyeXsKICAgICAgY29uc3QgdXJsPW5ldyBVUkwodSwgbG9jYXRpb24ub3JpZ2luKTsKICAgICAgWyJwYWdlIiwicGFnaW5hIiwiXyIsInQiLCJ0cyIsIm5vY2FjaGUiLCJjYWNoZUJ1c3QiLCJsaW1pdCIsInBlclBhZ2UiLCJwYWdlU2l6ZSIsInNpemUiLCJzdGF0dXMiXS5mb3JFYWNoKGs9PnVybC5zZWFyY2hQYXJhbXMuZGVsZXRlKGspKTsKICAgICAgdXJsLmhhc2g9IiI7CiAgICAgIHJldHVybiB1cmwub3JpZ2luICsgdXJsLnBhdGhuYW1lICsgKHVybC5zZWFyY2g/KCI/Iit1cmwuc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCkpOiIiKTsKICAgIH1jYXRjaHsgcmV0dXJuIFN0cmluZyh1fHwiIik7IH0KICB9CiAgZnVuY3Rpb24gbGF0Y2hMaXN0QmFzZSh1KXsKICAgIGlmICghdSB8fCAhaXNMaXN0KHUpKSByZXR1cm47CiAgICBTVEFURS5saXN0QmFzZSA9IG5vcm1hbGl6ZUJhc2UodSk7CiAgICB1cGRhdGVCYWRnZXMoKTsKICAgIGlmICghU1RBVEUuYmFzZUxvZ2dlZE9uY2UpewogICAgICBTVEFURS5iYXNlTG9nZ2VkT25jZSA9IHRydWU7CiAgICAgIGxvZygi4pyTIEJhc2UgZGEgTElTVEEgZGV0ZWN0YWRhLiIpOwogICAgfQogIH0KCiAgLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IEJFQVJFUiBUT0tFTiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBmdW5jdGlvbiBzZXRCZWFyZXIodil7CiAgICBpZiAoIXYpIHJldHVybjsKICAgIGNvbnN0IHM9U3RyaW5nKHYpLnRyaW0oKTsKICAgIGlmICghcyB8fCBzPT09U1RBVEUuYXV0aEhlYWRlcikgcmV0dXJuOwogICAgU1RBVEUuYXV0aEhlYWRlcj1zOwogICAgdHJ5eyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMU19CRUFSRVJfS0VZLCBzKTsgfWNhdGNoe30KICAgIHVwZGF0ZUJhZGdlcygpOwogIH0KICBjb25zdCBfZmV0Y2ggPSB3aW5kb3cuZmV0Y2g7CiAgd2luZG93LmZldGNoID0gZnVuY3Rpb24oaW5wdXQsIGluaXQpewogICAgdHJ5ewogICAgICBjb25zdCBoID0gaW5pdCAmJiBpbml0LmhlYWRlcnM7CiAgICAgIGlmIChoKXsKICAgICAgICBpZiAodHlwZW9mIGguZ2V0PT09ImZ1bmN0aW9uIil7CiAgICAgICAgICBjb25zdCB2ID0gaC5nZXQoIkF1dGhvcml6YXRpb24iKSB8fCBoLmdldCgiYXV0aG9yaXphdGlvbiIpOyBpZiAodikgc2V0QmVhcmVyKHYpOwogICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShoKSl7CiAgICAgICAgICBmb3IoY29uc3QgW2ssdl0gb2YgaCkgaWYgKFN0cmluZyhrKS50b0xvd2VyQ2FzZSgpPT09ImF1dGhvcml6YXRpb24iKSBzZXRCZWFyZXIodik7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaCA9PT0gIm9iamVjdCIpewogICAgICAgICAgZm9yKGNvbnN0IGsgaW4gaCkgaWYgKGsudG9Mb3dlckNhc2UoKT09PSJhdXRob3JpemF0aW9uIikgc2V0QmVhcmVyKGhba10pOwogICAgICAgIH0KICAgICAgfQogICAgfWNhdGNoe30KICAgIGNvbnN0IHVybCA9ICh0eXBlb2YgaW5wdXQ9PT0ic3RyaW5nIikgPyBpbnB1dCA6IChpbnB1dCAmJiBpbnB1dC51cmwpOwogICAgcmV0dXJuIF9mZXRjaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4ocmVzPT57CiAgICAgIHRyeXsKICAgICAgICBjb25zdCB1ID0gKHJlcyAmJiByZXMudXJsKSA/IHJlcy51cmwgOiAodXJsIHx8ICIiKTsKICAgICAgICBpZiAocmVzICYmIHJlcy5vayAmJiBpc0xpc3QodSkpIGxhdGNoTGlzdEJhc2UodSk7CiAgICAgIH1jYXRjaHt9CiAgICAgIHJldHVybiByZXM7CiAgICB9KTsKICB9OwogIGNvbnN0IFhIUiA9IHdpbmRvdy5YTUxIdHRwUmVxdWVzdDsKICBjb25zdCBfb3BlbiA9IFhIUi5wcm90b3R5cGUub3BlbjsKICBjb25zdCBfc2V0ICA9IFhIUi5wcm90b3R5cGUuc2V0UmVxdWVzdEhlYWRlcjsKICBjb25zdCBfc2VuZCA9IFhIUi5wcm90b3R5cGUuc2VuZDsKICBYSFIucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbihtLHUpeyB0aGlzLl9fdXJsPXU7IHJldHVybiBfb3Blbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7IH07CiAgWEhSLnByb3RvdHlwZS5zZXRSZXF1ZXN0SGVhZGVyID0gZnVuY3Rpb24oayx2KXsgdHJ5eyBpZihTdHJpbmcoaykudG9Mb3dlckNhc2UoKT09PSJhdXRob3JpemF0aW9uIikgc2V0QmVhcmVyKHYpO31jYXRjaHt9IHJldHVybiBfc2V0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTsgfTsKICBYSFIucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbigpewogICAgdHJ5ewogICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCAoKT0+eyB0cnl7IGlmICh0aGlzLnN0YXR1cz49MjAwICYmIHRoaXMuc3RhdHVzPDQwMCAmJiBpc0xpc3QodGhpcy5fX3VybCkpIGxhdGNoTGlzdEJhc2UodGhpcy5fX3VybCk7IH1jYXRjaHt9IH0pOwogICAgfWNhdGNoe30KICAgIHJldHVybiBfc2VuZC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7CiAgfTsKICBmdW5jdGlvbiB0cnlQZXJmKCl7CiAgICB0cnl7CiAgICAgIGNvbnN0IGVzPXBlcmZvcm1hbmNlLmdldEVudHJpZXNCeVR5cGUoInJlc291cmNlIik7CiAgICAgIGZvcihsZXQgaT1lcy5sZW5ndGgtMTtpPj0wO2ktLSl7IGNvbnN0IHU9ZXNbaV0ubmFtZXx8IiI7IGlmKGlzTGlzdCh1KSl7IGxhdGNoTGlzdEJhc2UodSk7IGJyZWFrOyB9IH0KICAgIH1jYXRjaHt9CiAgfQoKICAvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IFJFREUvTElTVEEgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwoKICAvLyDilrogQXBsaWNhIG8gZmlsdHJvIGRlIFNpdHVhw6fDo28gSsOBIE5BIEFQSSBhZGljaW9uYW5kbyBzdGF0dXM9IG5hIHF1ZXJ5LgogIC8vICAgIC0gZmlsdGVyVmFsdWUgImFsbCI6IG7Do28gYWRpY2lvbmEgbmFkYS4KICAvLyAgICAtIGZpbHRlclZhbHVlICJyZXQiOiBhZGljaW9uYSBzdGF0dXM9MTAwJnN0YXR1cz0xMDEmLi4uICh1bSBwb3IgaXRlbSkuCiAgLy8gICAgLSBmaWx0ZXJWYWx1ZSBudW3DqXJpY286IGFkaWNpb25hIHN0YXR1cz08bnVtPi4KICBmdW5jdGlvbiBhcHBseVNlcnZlckZpbHRlclRvVXJsKHUsIGZpbHRlclZhbHVlKXsKICAgIGNvbnN0IHVybCA9IG5ldyBVUkwodSwgbG9jYXRpb24ub3JpZ2luKTsKCiAgICAvLyBSZW1vdmUgc3RhdHVzIHByw6ktZXhpc3RlbnRlcwogICAgdXJsLnNlYXJjaFBhcmFtcy5kZWxldGUoInN0YXR1cyIpOwoKICAgIGlmIChmaWx0ZXJWYWx1ZSA9PT0gImFsbCIpIHsKICAgICAgcmV0dXJuIHVybC50b1N0cmluZygpOwogICAgfQogICAgaWYgKGZpbHRlclZhbHVlID09PSAicmV0IikgewogICAgICBmb3IgKGNvbnN0IHMgb2YgUkVUX1NUQVRVUykgdXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoInN0YXR1cyIsIFN0cmluZyhzKSk7CiAgICAgIHJldHVybiB1cmwudG9TdHJpbmcoKTsKICAgIH0KICAgIGNvbnN0IHdhbnQgPSBOdW1iZXIoZmlsdGVyVmFsdWUpOwogICAgaWYgKE51bWJlci5pc0Zpbml0ZSh3YW50KSkgewogICAgICB1cmwuc2VhcmNoUGFyYW1zLmFwcGVuZCgic3RhdHVzIiwgU3RyaW5nKHdhbnQpKTsKICAgIH0KICAgIHJldHVybiB1cmwudG9TdHJpbmcoKTsKICB9CgogIGFzeW5jIGZ1bmN0aW9uIGpnZXQodSl7CiAgICBjb25zdCByID0gYXdhaXQgZmV0Y2godSwgeyBoZWFkZXJzOiB7ICJBdXRob3JpemF0aW9uIjogU1RBVEUuYXV0aEhlYWRlciB9fSk7CiAgICBjb25zdCB0ID0gYXdhaXQgci50ZXh0KCk7CiAgICB0cnl7IHJldHVybiBKU09OLnBhcnNlKHQpOyB9Y2F0Y2h7IHRocm93IG5ldyBFcnJvcigiUmVzcG9zdGEgbsOjby1KU09OIik7IH0KICB9CgogIC8vIOKWuiBGb3LDp2EgMTAwIHBvciBww6FnaW5hIChzZW1wcmUpCiAgZnVuY3Rpb24gcGFnZVVybChiYXNlLCBuKXsKICAgIGNvbnN0IHUgPSBuZXcgVVJMKGJhc2UsIGxvY2F0aW9uLm9yaWdpbik7CgogICAgLy8gTm9ybWFsaXphIGEgcMOhZ2luYQogICAgaWYgKHUuc2VhcmNoUGFyYW1zLmhhcygicGFnZSIpKSB1LnNlYXJjaFBhcmFtcy5zZXQoInBhZ2UiLCBuKTsKICAgIGVsc2UgaWYgKHUuc2VhcmNoUGFyYW1zLmhhcygicGFnaW5hIikpIHUuc2VhcmNoUGFyYW1zLnNldCgicGFnaW5hIiwgbik7CiAgICBlbHNlIHUuc2VhcmNoUGFyYW1zLnNldCgicGFnZSIsIG4pOwoKICAgIC8vIEltcMO1ZSAxMDAgcG9yIHDDoWdpbmEgZW0gY2hhdmVzIGNvbXVucwogICAgdS5zZWFyY2hQYXJhbXMuc2V0KCJsaW1pdCIsICIxMDAiKTsKICAgIHUuc2VhcmNoUGFyYW1zLnNldCgicGVyUGFnZSIsICIxMDAiKTsKICAgIHUuc2VhcmNoUGFyYW1zLnNldCgicGFnZVNpemUiLCAiMTAwIik7CiAgICB1LnNlYXJjaFBhcmFtcy5zZXQoInNpemUiLCAiMTAwIik7CgogICAgcmV0dXJuIHUudG9TdHJpbmcoKTsKICB9CgogIGFzeW5jIGZ1bmN0aW9uIGdldExpc3RQYWdlKGJhc2UsIG4sIGZpbHRlclZhbHVlKXsKICAgIC8vIDEpIGNvbnN0csOzaSBVUkwgZGEgcMOhZ2luYSBjb20gMTAwIHBvciBww6FnaW5hCiAgICBsZXQgdSA9IHBhZ2VVcmwoYmFzZSwgbik7CiAgICAvLyAyKSBpbmpldGEgZmlsdHJvIGRlIFNpdHVhw6fDo28gbmEgcXVlcnkgKHNlcnZlci1zaWRlKQogICAgdSA9IGFwcGx5U2VydmVyRmlsdGVyVG9VcmwodSwgZmlsdGVyVmFsdWUpOwogICAgY29uc3QgZCA9IGF3YWl0IGpnZXQodSk7CiAgICBpZiAoQXJyYXkuaXNBcnJheShkKSkgcmV0dXJuIGQ7CiAgICBmb3IgKGNvbnN0IGsgb2YgWyJhcnJheURhdGEiLCJpdGVtcyIsImRhdGEiLCJyb3dzIiwicmVjb3JkcyJdKSBpZiAoQXJyYXkuaXNBcnJheShkPy5ba10pKSByZXR1cm4gZFtrXTsKICAgIHJldHVybiBbXTsKICB9CgogIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PSBTSVRVQcOHw4NPIENBTsOUTklDQSA9PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBmdW5jdGlvbiBzaXR1YWNhb0Zyb21TdGF0dXMoY29kZSl7CiAgICBpZiAoUkVUX1NUQVRVUy5oYXMoY29kZSkpIHJldHVybiBTSVRVQUNBT19NQVBbY29kZV07CiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKFNJVFVBQ0FPX01BUCwgY29kZSkpIHJldHVybiBTSVRVQUNBT19NQVBbY29kZV07CiAgICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKGNvZGUpID8gYFN0YXR1cyAke2NvZGV9YCA6ICItLS0tLSI7CiAgfQoKICAvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PSBGSUxUUk8gREUgU0lUVUHDh8ODTyAoZmFsbGJhY2spID09PT09PT09PT09PT09PT09ICovCiAgLy8gTWFudGVtb3MgbyBmaWx0cm8gY2xpZW50LXNpZGUgY29tbyBzZWd1cmFuw6dhIGVtIGNhc28gZGEgQVBJIGlnbm9yYXIgc3RhdHVzLgogIGZ1bmN0aW9uIHBhc3NGaWx0ZXIoY29kZSwgZmlsdGVyVmFsdWUpewogICAgaWYgKGZpbHRlclZhbHVlID09PSAiYWxsIikgcmV0dXJuIHRydWU7CiAgICBpZiAoZmlsdGVyVmFsdWUgPT09ICJyZXQiKSByZXR1cm4gUkVUX1NUQVRVUy5oYXMoY29kZSk7CiAgICBjb25zdCB3YW50ID0gTnVtYmVyKGZpbHRlclZhbHVlKTsKICAgIHJldHVybiBOdW1iZXIuaXNGaW5pdGUod2FudCkgJiYgY29kZSA9PT0gd2FudDsKICB9CgogIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT0gREFUQVMgKExJTVBFWkEpID09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBmdW5jdGlvbiBwYXJzZURhdGVDYW5kaWRhdGUodil7CiAgICBpZiAodiA9PSBudWxsKSByZXR1cm4gbnVsbDsKICAgIGxldCB4ID0gdjsKICAgIGlmICh0eXBlb2YgeCA9PT0gIm9iamVjdCIpIHggPSB4LmRhdGUgfHwgeC5kYXRhIHx8IHguZGF0YUhvcmEgfHwgeC52YWx1ZSB8fCB4OwogICAgaWYgKHR5cGVvZiB4ICE9PSAic3RyaW5nIikgeCA9IFN0cmluZyh4KTsKICAgIGxldCB0ID0geC50cmltKCk7CiAgICBjb25zdCBtID0gdC5tYXRjaCgvXihcZHs0fS1cZHsyfS1cZHsyfSlbIFRdKFxkezJ9OlxkezJ9OlxkezJ9KSg/OlwuXGR7Myw2fSk/JC8pOwogICAgaWYgKG0pIHQgPSBgJHttWzFdfVQke21bMl19YDsKICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSh0KTsKICAgIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsKICAgIHJldHVybiB0LnJlcGxhY2UoL1wuXGR7Myw2fSQvLCAiIik7CiAgfQogIGZ1bmN0aW9uIGZtdEJyKHZhbCl7CiAgICBjb25zdCBkID0gcGFyc2VEYXRlQ2FuZGlkYXRlKHZhbCk7CiAgICBpZiAoZCA9PSBudWxsKSByZXR1cm4gIi0tLS0tIjsKICAgIGlmIChkIGluc3RhbmNlb2YgRGF0ZSkgcmV0dXJuIGAke3AyKGQuZ2V0RGF0ZSgpKX0vJHtwMihkLmdldE1vbnRoKCkrMSl9LyR7ZC5nZXRGdWxsWWVhcigpfSAke3AyKGQuZ2V0SG91cnMoKSl9OiR7cDIoZC5nZXRNaW51dGVzKCkpfWA7CiAgICByZXR1cm4gZDsKICB9CgogIC8qID09PT09PT09PT09PT09PT09PT09PT09IEVOREVSRcOHTyAoTElTVEEtT05MWTsgT1BDSU9OQUwpID09PT09PT09PT09PT09PT09PSAqLwogIGZ1bmN0aW9uIHBpY2tFbmRlcmVjb0Zyb21MaXN0KGl0ZW0sIG9yaWdpbil7CiAgICBpZiAob3JpZ2luID09PSAiYXByZWVuc2FvIil7CiAgICAgIHJldHVybiBbCiAgICAgICAgc2FmZShpdGVtPy5lbmRlcmVjb0FwcmVlbnNhbyksCiAgICAgICAgc2FmZShpdGVtPy5iYWlycm9BcHJlZW5zYW8pLAogICAgICAgIHNhZmUoaXRlbT8uY2lkYWRlQXByZWVuc2FvKSwKICAgICAgICBzYWZlKGl0ZW0/LnVmQXByZWVuc2FvKSwKICAgICAgICBzYWZlKGl0ZW0/LmNvbXBsZW1lbnRvQXByZWVuc2FvKSwKICAgICAgXTsKICAgIH0gZWxzZSB7IC8vIHJlbW9jYW8KICAgICAgcmV0dXJuIFsKICAgICAgICBzYWZlKGl0ZW0/LmVuZGVyZWNvUmVtb2NhbyksCiAgICAgICAgc2FmZShpdGVtPy5iYWlycm9SZW1vY2FvKSwKICAgICAgICBzYWZlKGl0ZW0/LmNpZGFkZVJlbW9jYW8pLAogICAgICAgIHNhZmUoaXRlbT8udWZSZW1vY2FvKSwKICAgICAgICBzYWZlKGl0ZW0/LmNvbXBsZW1lbnRvUmVtb2NhbyksCiAgICAgIF07CiAgICB9CiAgfQoKICAvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gUE9MSUNJQUwgKERFVEFMSEUpID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwogIGZ1bmN0aW9uIGdldFBvbGljaWFsT2ZpY2lhbEZyb21EZXRhbGhlKGRldCl7CiAgICBjb25zdCBwID0gZGV0Py5wb2xpY2lhbEFwcmVlbnNhbyB8fCBkZXQ/LnBvbGljaWFsIHx8IGRldD8uYWdlbnRlQXByZWVuc29yIHx8IG51bGw7CiAgICBjb25zdCBub21lID0gc2FmZShwPy5ub21lKTsKICAgIGNvbnN0IG1hdCAgPSBzYWZlKHA/Lm1hdHJpY3VsYSk7CiAgICByZXR1cm4ge25vbWUsIG1hdH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlUG9saWNpYWxGcm9tT2JzZXJ2YWNhbyh0ZXh0KXsKICBpZiAoIXRleHQpIHJldHVybiB7bm9tZU9iczoiLS0tLS0iLCBtYXRPYnM6Ii0tLS0tIn07CgogIC8vIE5vcm1hbGl6YcOnw6NvCiAgbGV0IHQgPSBTdHJpbmcodGV4dCkKICAgIC5yZXBsYWNlKC9cclxuPy9nLCAiXG4iKQogICAgLnJlcGxhY2UoL1x1MDBBMC9nLCAiICIpCiAgICAucmVwbGFjZSgvXCorL2csICIiKSAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG5lZ3JpdG8vYXN0ZXJpc2NvcwogICAgLnJlcGxhY2UoL1sgXHRdKy9nLCAiICIpCiAgICAucmVwbGFjZSgvWyBcdF0qXG5bIFx0XSovZywgIlxuIik7CiAgLy8gSnVudGEgZMOtZ2l0b3MgcXVlYnJhZG9zIHBvciBxdWVicmEgZGUgbGluaGEKICB0ID0gdC5yZXBsYWNlKC8oXGQpW15cU1xuXSpcblteXFNcbl0qKFxkKS9nLCAiJDEkMiIpOwoKICBjb25zdCBkaWdpdHMgPSBzID0+IFN0cmluZyhzfHwiIikucmVwbGFjZSgvXEQrL2csICIiKTsKICBjb25zdCBjbGVhbiAgPSBzID0+IFN0cmluZyhzfHwiIikucmVwbGFjZSgvWyBcdF0rL2csICIgIikudHJpbSgpOwoKICAvLyAtLS0tLS0tLS0tIE1hdHLDrWN1bGEvUkcgLS0tLS0tLS0tLQogIGxldCBtYXRPYnMgPSAiLS0tLS0iOwogIC8vIFLDs3R1bG9zIGNvbSBkZWxpbWl0YWRvcmVzIGRlIHBhbGF2cmEgcGFyYSBldml0YXIgZmFsc28tcG9zaXRpdm8gKGV4LjogIkNhcmdvL1BhdGVudGUiKQogIGNvbnN0IG0gPSB0Lm1hdGNoKC9cYig/Ok1hdFwuP1xzKlwvP1xzKlJHfE1hdHIoPzpcLnxbw61pXWN1bGEpP3xNYXRyaWMoPzp1bGEpP3xNYXRcLj98UkcoPzpcL0lEKT8pXGJccypbOlwtXT9ccyooW15cbl0rKS9pKTsKICBpZiAobSl7CiAgICBjb25zdCBkID0gZGlnaXRzKG1bMV0pOwogICAgaWYgKGQubGVuZ3RoPj01ICYmIGQubGVuZ3RoPD0xMikgewogICAgICBtYXRPYnMgPSBkOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgbWQgPSBtWzFdLm1hdGNoKC9cYihcZHs1LDEyfSlcYi8pOwogICAgICBpZiAobWQpIG1hdE9icyA9IG1kWzFdOwogICAgfQogIH0gZWxzZSB7CiAgICAvLyBGYWxsYmFjayByZXN0cml0bzogbGluaGEgcXVlIG1lbmNpb25hIE1hdC9SRyAoZXZpdGEgcGVnYXIgIkNlbC4iL3RlbGVmb25lKQogICAgY29uc3QgbGluZSA9IHQuc3BsaXQoIlxuIikuZmluZChsID0+IC9cYk1hdC9pLnRlc3QobCkgfHwgL1xiUkdcYi9pLnRlc3QobCkpOwogICAgaWYgKGxpbmUpewogICAgICBjb25zdCBkcm9wID0gbGluZS5yZXBsYWNlKC9DZWxcLj86LiokL2ksICIiKTsKICAgICAgY29uc3QgZCA9IGRpZ2l0cyhkcm9wKTsKICAgICAgY29uc3QgbWQgPSBkLm1hdGNoKC8oXGR7NSwxMn0pLyk7CiAgICAgIGlmIChtZCkgbWF0T2JzID0gbWRbMV07CiAgICB9CiAgfQoKICAvLyAtLS0tLS0tLS0tIE5vbWUgLS0tLS0tLS0tLQogIGxldCBub21lT2JzID0gIi0tLS0tIjsKICAvLyAiTm9tZSBlIENhcmdvL1BhdGVudGU6IiBvdSAiTm9tZTogLi4uIgogIGxldCBuID0gdC5tYXRjaCgvXGJOb21lXHMqKD86ZVxzKkNhcmdvXC8/UGF0ZW50ZXxcLz9DYXJnb1wvP1BhdGVudGUpP1xzKjpccyooW15cbl0rKS9pKTsKICBpZiAobil7CiAgICBsZXQgc2VnID0gblsxXTsKICAgIC8vIENvcnRhIHNlIGEgbWVzbWEgbGluaGEgY29udGludWFyIGNvbSBvdXRyb3MgcsOzdHVsb3MKICAgIHNlZyA9IHNlZy5zcGxpdCgvXGIoTWF0XC4/XC8/Ukd8TWF0XC4/fE1hdHIoPzpcLnxbw61pXWN1bGEpP3xSRyg/OlwvSUQpP3xVbmlkYWRlfE5bwrpvXVxzKmRhXHMqVlRSfENlbFwuPylcYi9pKVswXTsKICAgIG5vbWVPYnMgPSBjbGVhbihzZWcpOwogIH0gZWxzZSBpZiAoKG4gPSB0Lm1hdGNoKC9cYk5vbWVccyo6XHMqKFteXG5dKykvaSkpKXsKICAgIGxldCBzZWcgPSBuWzFdOwogICAgc2VnID0gc2VnLnNwbGl0KC9cYihDYXJnb3xDYXJnb1wvP1BhdGVudGV8TWF0XC4/XC8/Ukd8TWF0XC4/fE1hdHIoPzpcLnxbw61pXWN1bGEpP3xSRyg/OlwvSUQpPylcYi9pKVswXTsKICAgIG5vbWVPYnMgPSBjbGVhbihzZWcpOwogIH0gZWxzZSBpZiAoKG4gPSB0Lm1hdGNoKC9cYihQb2xpY2lhbHxBcHJlZW5zb3J8QWdlbnRlfEluc3BldG9yfE9maWNpYWwpXHMqOlxzKihbXlxuXSspL2kpKSkgewogICAgbm9tZU9icyA9IGNsZWFuKG5bMl0pOwogIH0gZWxzZSB7CiAgICAvLyBIZXVyw61zdGljYTogcHJpbWVpcmEgbGluaGEgw7p0aWwgYXDDs3MgIkRBRE9TIERPIFNPTElDSVRBTlRFIgogICAgbGV0IGFmdGVyID0gdDsKICAgIGNvbnN0IGggPSB0Lm1hdGNoKC9EQURPUyBETyBTT0xJQ0lUQU5URS9pKTsKICAgIGlmIChoKSBhZnRlciA9IHQuc2xpY2UoaC5pbmRleCArIGhbMF0ubGVuZ3RoKTsKICAgIGNvbnN0IGxpbmUgPSBhZnRlci5zcGxpdCgiXG4iKS5tYXAocz0+cy50cmltKCkpCiAgICAgIC5maW5kKHMgPT4gcyAmJiAhL15cZHs1LH0kLy50ZXN0KGRpZ2l0cyhzKSkgJiYgIS8oVW5pZGFkZXxWVFJ8Q2VsfEZvaSBhY2lvbmFkb3xOb21lIGRvIHRlcmNlaXJvfFJHXC9JRCkvaS50ZXN0KHMpKTsKICAgIGlmIChsaW5lKSBub21lT2JzID0gbGluZTsKICB9CgogIC8vIFRyYXRhICJOb21lL0NhcmdvIiDihpIgbWFudMOpbSBhcGVuYXMgbyBub21lIHF1YW5kbyBhIGRpcmVpdGEgcGFyZWNlIHBhdGVudGUvY2FyZ28KICBpZiAobm9tZU9icy5pbmNsdWRlcygiLyIpKXsKICAgIGNvbnN0IFtsZWZ0LHJpZ2h0XSA9IG5vbWVPYnMuc3BsaXQoIi8iKS5tYXAocz0+cy50cmltKCkpOwogICAgaWYgKHJpZ2h0ICYmIC9eKGNhYm98Y2JwbXxzZ3R8c29sZGFkb3xzZHx0ZW58dGVuZW50ZXxjYXB8Y2FwaXR8aW5zcHxhZ2VudGV8aW52ZXN0aWdhZG9yfG9maWNpYWwpXGIvaS50ZXN0KHJpZ2h0KSkgewogICAgICBub21lT2JzID0gbGVmdDsKICAgIH0KICB9CgogIHJldHVybiB7bm9tZU9icywgbWF0T2JzfTsKfQoKCiAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hEZXRhbGhlQnlJZE9yTnVtZXJvKGxpc3RJdGVtKXsKICAgIGNvbnN0IGFwaU9yaWdpbiA9IChTVEFURS5saXN0QmFzZSA/IG5ldyBVUkwoU1RBVEUubGlzdEJhc2UpLm9yaWdpbiA6IGxvY2F0aW9uLm9yaWdpbik7CiAgICBjb25zdCBoZWFkZXJzID0geyAiQXV0aG9yaXphdGlvbiI6IFNUQVRFLmF1dGhIZWFkZXIsICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIgfTsKCiAgICBhc3luYyBmdW5jdGlvbiBqZ2V0Mih1cmwpewogICAgICBjb25zdCByID0gYXdhaXQgZmV0Y2godXJsLCB7IGhlYWRlcnMgfSk7CiAgICAgIGNvbnN0IGN0ID0gKHIuaGVhZGVycy5nZXQoImNvbnRlbnQtdHlwZSIpIHx8ICIiKS50b0xvd2VyQ2FzZSgpOwogICAgICBjb25zdCB0eHQgPSBhd2FpdCByLnRleHQoKTsKICAgICAgaWYgKCFjdC5pbmNsdWRlcygianNvbiIpKSB0aHJvdyBuZXcgRXJyb3IoYG7Do28tSlNPTiAoJHtyLnN0YXR1c30pYCk7CiAgICAgIHRyeSB7IHJldHVybiBKU09OLnBhcnNlKHR4dCk7IH0KICAgICAgY2F0Y2goZSl7IHRocm93IG5ldyBFcnJvcihganNvbiBpbnbDoWxpZG8gKCR7ci5zdGF0dXN9KWApOyB9CiAgICB9CgogICAgY29uc3QgaWQgPSBsaXN0SXRlbT8uaWQgfHwgbGlzdEl0ZW0/LmdydklkIHx8IG51bGw7CiAgICBpZiAoaWQgIT0gbnVsbCl7CiAgICAgIHJldHVybiBhd2FpdCBqZ2V0MihgJHthcGlPcmlnaW59L2FwaS9ncnYvJHtpZH0/ZGFkb3NFeHRyYXM9dHJ1ZWApOwogICAgfQoKICAgIGNvbnN0IG51bWVybyA9IGxpc3RJdGVtPy5udW1lcm87CiAgICBpZiAoIW51bWVybykgdGhyb3cgbmV3IEVycm9yKCJzZW0gaWQgZSBzZW0gbnVtZXJvIik7CiAgICBjb25zdCBxcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoeyBudW1lcm86IFN0cmluZyhudW1lcm8pIH0pLnRvU3RyaW5nKCk7CgogICAgY29uc3Qgc2VhcmNoID0gYXdhaXQgamdldDIoYCR7YXBpT3JpZ2lufS9hcGkvZ3J2PyR7cXN9YCk7CiAgICBsZXQgZm91bmQgPSBudWxsOwogICAgaWYgKEFycmF5LmlzQXJyYXkoc2VhcmNoKSl7CiAgICAgIGZvdW5kID0gc2VhcmNoWzBdOwogICAgfSBlbHNlIGlmIChzZWFyY2ggJiYgdHlwZW9mIHNlYXJjaCA9PT0gIm9iamVjdCIpewogICAgICBmb3IgKGNvbnN0IGsgb2YgWyJhcnJheURhdGEiLCJpdGVtcyIsImRhdGEiLCJyb3dzIiwicmVjb3JkcyJdKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoc2VhcmNoW2tdKSkgeyBmb3VuZCA9IHNlYXJjaFtrXVswXTsgYnJlYWs7IH0KICAgICAgfQogICAgICBpZiAoIWZvdW5kICYmIHNlYXJjaC5pZCkgZm91bmQgPSBzZWFyY2g7CiAgICB9CiAgICBjb25zdCByaWQgPSBmb3VuZD8uaWQgfHwgZm91bmQ/LmdydklkOwogICAgaWYgKHJpZCA9PSBudWxsKSB0aHJvdyBuZXcgRXJyb3IoIm7Do28gZm9pIHBvc3PDrXZlbCByZXNvbHZlciBpZCBwZWxvIG51bWVybyIpOwogICAgcmV0dXJuIGF3YWl0IGpnZXQyKGAke2FwaU9yaWdpbn0vYXBpL2dydi8ke3JpZH0/ZGFkb3NFeHRyYXM9dHJ1ZWApOwogIH0KCiAgLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09IE1BUEVBTUVOVE8gREUgTElOSEEgPT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBmdW5jdGlvbiBiYXNlUm93KGl0ZW0pewogICAgY29uc3QgY29kZSA9IE51bWJlcihpdGVtPy5zdGF0dXMpOwogICAgY29uc3Qgc2l0dSA9IHNpdHVhY2FvRnJvbVN0YXR1cyhjb2RlKTsKICAgIGNvbnN0IGlzUmV0ID0gUkVUX1NUQVRVUy5oYXMoY29kZSk7CiAgICByZXR1cm4gWwogICAgICBzYWZlKGl0ZW0/Lm51bWVybyksCiAgICAgIHNhZmUoaXRlbT8ucGxhY2FPcmlnaW5hbCksCiAgICAgIHNhZmUoaXRlbT8ucGxhY2EgfHwgIi0tLS0iKSwKICAgICAgc2FmZShpdGVtPy5jaGFzc2kpLAogICAgICBmbXRCcihpdGVtPy5kYXRhQXByZWVuc2FvPy5kYXRlIHx8IGl0ZW0/LmRhdGFBcHJlZW5zYW8gfHwgaXRlbT8uYXByZWVuc2FvRGF0YSksCiAgICAgIGlzUmV0ID8gZm10QnIoCiAgICAgICAgaXRlbT8ucmV0aXJhZGE/LmRhdGFSZXRpcmFkYT8uZGF0ZSB8fAogICAgICAgIGl0ZW0/LmRhdGFSZXRpcmFkYT8uZGF0ZSB8fCBpdGVtPy5kYXRhUmV0aXJhZGEgfHwKICAgICAgICBpdGVtPy5kYXRhU2FpZGFQYXRpbz8uZGF0ZSB8fCBpdGVtPy5kYXRhU2FpZGFQYXRpbyB8fAogICAgICAgIGl0ZW0/LmJhaXhhPy5kYXRlIHx8IGl0ZW0/LmxpYmVyYWNhbz8uZGF0ZQogICAgICApIDogIi0tLS0tIiwKICAgICAgc2FmZShpdGVtPy5tYXJjYSB8fCBpdGVtPy5tYXJjYU1vZGVsbyB8fCBpdGVtPy5tb2RlbG8pLAogICAgICBzYWZlKGl0ZW0/LnBhdGlvPy5ub21lIHx8IGl0ZW0/LnBhdGlvTm9tZSksCiAgICAgIHNhZmUoaXRlbT8udmFnYSksCiAgICAgIHNhZmUoaXRlbT8ubnVtZXJvQ2hhdmUpLAogICAgICBzaXR1CiAgICBdOwogIH0KCiAgLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gVUkgKFBBSU5FTCkgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBsZXQgcGFuZWwsIGxvZ0VsLCBiYWRnZVRvaywgYmFkZ2VCYXNlLCBpblN0YXJ0LCBpbkVuZCwgc2VsRmlsdGVyLCBidG5SdW4sIGJ0blhMU1gsIGJ0bkNvcHksIGJ0bkNvcHlMb2c7CiAgbGV0IGNoa0FkZHIsIGFkZHJCb3gsIHJhZEFwLCByYWRSbSwgcmFkQm90aDsKICBsZXQgY2hrUG9sLCBwb2xCb3gsIGNoa1BvbE9maWNpYWwsIGNoa1BvbE9iczsKCiAgZnVuY3Rpb24gYnVpbGRQYW5lbCgpewogICAgcGFuZWw9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICBwYW5lbC5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjpmaXhlZDtyaWdodDoyMHB4O2JvdHRvbToyMHB4O3otaW5kZXg6MjE0NzQ4MzY0NztiYWNrZ3JvdW5kOiMwZDExMTc7Y29sb3I6I2U2ZWRmMztib3JkZXI6MXB4IHNvbGlkICMzMDM2M2Q7Ym9yZGVyLXJhZGl1czoxMHB4O3dpZHRoOjYxMHB4O2JveC1zaGFkb3c6MCA4cHggMjBweCByZ2JhKDAsMCwwLC41NSk7Zm9udC1mYW1pbHk6U2Vnb2UgVUksQXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTNweDsiOwogICAgcGFuZWwuaW5uZXJIVE1MPWAKICAgICAgPGRpdiBzdHlsZT0icGFkZGluZzo2cHggMTBweDtkaXNwbGF5OmZsZXg7Z2FwOjhweDthbGlnbi1pdGVtczpjZW50ZXI7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgIzMwMzYzZDtjdXJzb3I6bW92ZTtiYWNrZ3JvdW5kOiMwMTA0MDk7Ij4KICAgICAgICA8YiBzdHlsZT0iZmxleDoxOyI+R1JWIFRvb2xzIGNvbSBFbmRlcmXDp28gZSBQb2xpY2lhbCAzIGVtIDEgdjEuNC4zPC9iPgogICAgICAgIDxzcGFuIGlkPSJncnZfYmFkZ2VfdG9rIiAgc3R5bGU9ImZvbnQtc2l6ZToxMHB4O29wYWNpdHk6Ljk7bWF4LXdpZHRoOjIwMHB4O3doaXRlLXNwYWNlOm5vd3JhcDtvdmVyZmxvdzpoaWRkZW47dGV4dC1vdmVyZmxvdzplbGxpcHNpcyI+VG9rZW46IOKAlDwvc3Bhbj4KICAgICAgICA8c3BhbiBpZD0iZ3J2X2JhZGdlX2Jhc2UiIHN0eWxlPSJmb250LXNpemU6MTBweDtvcGFjaXR5Oi45O21heC13aWR0aDoyNjBweDt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXMiPkJhc2U6IOKAlDwvc3Bhbj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6MWZyIDFmciAxZnI7Z2FwOjhweDtwYWRkaW5nOjhweDsiPgogICAgICAgIDxkaXY+PGxhYmVsIHN0eWxlPSJmb250LXNpemU6MTFweDtvcGFjaXR5Oi44Ij5JbsOtY2lvIChww6FnaW5hKTwvbGFiZWw+PGlucHV0IGlkPSJncnZfc3RhcnQiIHR5cGU9Im51bWJlciIgbWluPSIxIiB2YWx1ZT0iMSIgc3R5bGU9IndpZHRoOjEwMCU7YmFja2dyb3VuZDojMGQxMTE3O2NvbG9yOiNlNmVkZjM7Ym9yZGVyOjFweCBzb2xpZCAjMzAzNjNkO2JvcmRlci1yYWRpdXM6NnB4O3BhZGRpbmc6NnB4Ij48L2Rpdj4KICAgICAgICA8ZGl2PjxsYWJlbCBzdHlsZT0iZm9udC1zaXplOjExcHg7b3BhY2l0eTouOCI+RmltICgwID0gYXTDqSB6ZXJhcik8L2xhYmVsPjxpbnB1dCBpZD0iZ3J2X2VuZCIgdHlwZT0ibnVtYmVyIiBtaW49IjAiIHZhbHVlPSI1IiBzdHlsZT0id2lkdGg6MTAwJTtiYWNrZ3JvdW5kOiMwZDExMTc7Y29sb3I6I2U2ZWRmMztib3JkZXI6MXB4IHNvbGlkICMzMDM2M2Q7Ym9yZGVyLXJhZGl1czo2cHg7cGFkZGluZzo2cHgiPjwvZGl2PgogICAgICAgIDxkaXY+CiAgICAgICAgICA8bGFiZWwgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O29wYWNpdHk6LjgiPkZpbHRyYXIgU2l0dWHDp8OjbzwvbGFiZWw+CiAgICAgICAgICA8c2VsZWN0IGlkPSJncnZfZmlsdGVyIiBzdHlsZT0id2lkdGg6MTAwJTtiYWNrZ3JvdW5kOiMwZDExMTc7Y29sb3I6I2U2ZWRmMztib3JkZXI6MXB4IHNvbGlkICMzMDM2M2Q7Ym9yZGVyLXJhZGl1czo2cHg7cGFkZGluZzo2cHgiPjwvc2VsZWN0PgogICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOjEwcHg7b3BhY2l0eTouNzttYXJnaW4tdG9wOjRweCI+UGFkcsOjbyBmaXhvOiAiTm8gcMOhdGlvIjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KCiAgICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6MCA4cHggNnB4IDhweDtmb250LXNpemU6MTFweDtvcGFjaXR5Oi44NSI+CiAgICAgICAgTyBzY3JpcHQgZm9yw6dhIDxiPjEwMCBwb3IgcMOhZ2luYTwvYj4gZSBpbmpldGEgPGNvZGU+c3RhdHVzPTwvY29kZT4gbmEgQVBJIGNvbmZvcm1lIG8gZmlsdHJvIGRvIHNjcmlwdC4KICAgICAgICBTZSDigJxGaW3igJ09NSwgYSBtZXRhIMOpIGp1bnRhciA8Yj41MDAgbWFudGlkb3M8L2I+IHBlbG8gZmlsdHJvIChvdSBhdMOpIGEgbGlzdGEgemVyYXIpLgogICAgICA8L2Rpdj4KCiAgICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6OHB4O2JvcmRlci10b3A6MXB4IHNvbGlkICMzMDM2M2QiPgogICAgICAgIDxsYWJlbCBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6OHB4O2N1cnNvcjpwb2ludGVyIj4KICAgICAgICAgIDxpbnB1dCBpZD0iZ3J2X2FkZHJfZW5hYmxlIiB0eXBlPSJjaGVja2JveCI+CiAgICAgICAgICA8c3Bhbj5JbmNsdWlyIGVuZGVyZcOnbzwvc3Bhbj4KICAgICAgICA8L2xhYmVsPgogICAgICAgIDxkaXYgaWQ9Imdydl9hZGRyX2JveCIgc3R5bGU9ImRpc3BsYXk6bm9uZTttYXJnaW4tdG9wOjZweDtwYWRkaW5nOjhweDtiYWNrZ3JvdW5kOiMwYTBmMTQ7Ym9yZGVyOjFweCBzb2xpZCAjMzAzNjNkO2JvcmRlci1yYWRpdXM6NnB4Ij4KICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi1ib3R0b206NnB4O2ZvbnQtc2l6ZToxMnB4O29wYWNpdHk6LjkiPk9yaWdlbTo8L2Rpdj4KICAgICAgICAgIDxsYWJlbCBzdHlsZT0ibWFyZ2luLXJpZ2h0OjEycHgiPjxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iZ3J2X2FkZHJfb3JpZ2luIiB2YWx1ZT0iYXByZWVuc2FvIiBjaGVja2VkPiBBcHJlZW5zw6NvPC9sYWJlbD4KICAgICAgICAgIDxsYWJlbCBzdHlsZT0ibWFyZ2luLXJpZ2h0OjEycHgiPjxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iZ3J2X2FkZHJfb3JpZ2luIiB2YWx1ZT0icmVtb2NhbyI+IFJlbW/Dp8OjbzwvbGFiZWw+CiAgICAgICAgICA8bGFiZWw+PGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJncnZfYWRkcl9vcmlnaW4iIHZhbHVlPSJhbWJvcyI+IEFtYm9zPC9sYWJlbD4KICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZToxMHB4O29wYWNpdHk6Ljc7bWFyZ2luLXRvcDo2cHgiPkxJU1RBLW9ubHk7IGNhbXBvcyBhdXNlbnRlcyBmaWNhbSAiLS0tLS0iLjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KCiAgICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6OHB4O2JvcmRlci10b3A6MXB4IHNvbGlkICMzMDM2M2QiPgogICAgICAgIDxsYWJlbCBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6OHB4O2N1cnNvcjpwb2ludGVyIj4KICAgICAgICAgIDxpbnB1dCBpZD0iZ3J2X3BvbF9lbmFibGUiIHR5cGU9ImNoZWNrYm94Ij4KICAgICAgICAgIDxzcGFuPkluY2x1aXIgcG9saWNpYWwgKHVzYSBERVRBTEhFKTwvc3Bhbj4KICAgICAgICA8L2xhYmVsPgogICAgICAgIDxkaXYgaWQ9Imdydl9wb2xfYm94IiBzdHlsZT0iZGlzcGxheTpub25lO21hcmdpbi10b3A6NnB4O3BhZGRpbmc6OHB4O2JhY2tncm91bmQ6IzBhMGYxNDtib3JkZXI6MXB4IHNvbGlkICMzMDM2M2Q7Ym9yZGVyLXJhZGl1czo2cHgiPgogICAgICAgICAgPGxhYmVsIHN0eWxlPSJtYXJnaW4tcmlnaHQ6MTJweCI+PGlucHV0IGlkPSJncnZfcG9sX29maWNpYWwiIHR5cGU9ImNoZWNrYm94IiBjaGVja2VkPiBPZmljaWFpcyAobm9tZS9tYXRyw61jdWxhKTwvbGFiZWw+CiAgICAgICAgICA8bGFiZWw+PGlucHV0IGlkPSJncnZfcG9sX29icyIgdHlwZT0iY2hlY2tib3giPiBPYnNlcnZhw6fDo28gKG5vbWUvbWF0csOtY3VsYSk8L2xhYmVsPgogICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOjEwcHg7b3BhY2l0eTouNzttYXJnaW4tdG9wOjZweCI+REVUQUxIRSBjb20gMiB3b3JrZXJzIGZpeG9zOyBmYWxoYXMgcHJlZW5jaGVtICItLS0tLSIgZSBzw6NvIGxvZ2FkYXMuPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgoKICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7cGFkZGluZzo4cHg7ZmxleC13cmFwOndyYXA7Ym9yZGVyLXRvcDoxcHggc29saWQgIzMwMzYzZCI+CiAgICAgICAgPGJ1dHRvbiBpZD0iZ3J2X3J1biIgICBzdHlsZT0iZmxleDoxO3BhZGRpbmc6OHB4O2JvcmRlci1yYWRpdXM6NnB4O2JhY2tncm91bmQ6IzIzODYzNjtjb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgIzJlYTA0MztjdXJzb3I6cG9pbnRlciI+Q2FwdHVyYXI8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGlkPSJncnZfeGxzeCIgIHN0eWxlPSJmbGV4OjE7cGFkZGluZzo4cHg7Ym9yZGVyLXJhZGl1czo2cHg7YmFja2dyb3VuZDojMWY2ZmViO2NvbG9yOiNmZmY7Ym9yZGVyOjFweCBzb2xpZCAjMzg4YmZkO2N1cnNvcjpwb2ludGVyIiBkaXNhYmxlZD5CYWl4YXIgWExTWDwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9Imdydl9jb3B5IiAgc3R5bGU9ImZsZXg6MTtwYWRkaW5nOjhweDtib3JkZXItcmFkaXVzOjZweDtiYWNrZ3JvdW5kOiM5ZTZjMDA7Y29sb3I6I2ZmZjtib3JkZXI6MXB4IHNvbGlkICNiODg0MDA7Y3Vyc29yOnBvaW50ZXIiIGRpc2FibGVkPkNvcGlhciBUU1Y8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGlkPSJncnZfY29weV9sb2ciIHN0eWxlPSJmbGV4OjE7cGFkZGluZzo4cHg7Ym9yZGVyLXJhZGl1czo2cHg7YmFja2dyb3VuZDojNmU3NjgxO2NvbG9yOiMwZDExMTc7Ym9yZGVyOjFweCBzb2xpZCAjOGI5NDllO2N1cnNvcjpwb2ludGVyIj5Db3BpYXIgTG9nPC9idXR0b24+CiAgICAgIDwvZGl2PgoKICAgICAgPHRleHRhcmVhIGlkPSJncnZfbG9nIiByZWFkb25seSBzdHlsZT0id2lkdGg6Y2FsYygxMDAlIC0gMTZweCk7bWFyZ2luOjAgOHB4IDhweDtoZWlnaHQ6MjQwcHg7YmFja2dyb3VuZDojMGEwZjE0O2NvbG9yOiNkMWY3YzQ7Ym9yZGVyOjFweCBzb2xpZCAjMzAzNjNkO2JvcmRlci1yYWRpdXM6NnB4O3Jlc2l6ZTp2ZXJ0aWNhbDtmb250LWZhbWlseTp1aS1tb25vc3BhY2UsQ29uc29sYXMsTWVubG8sbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMnB4O3BhZGRpbmc6OHB4Ij48L3RleHRhcmVhPgogICAgYDsKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGFuZWwpOwoKICAgIC8vIGFycmFzdGFyIHBhaW5lbAogICAgY29uc3QgaGVhZD1wYW5lbC5maXJzdEVsZW1lbnRDaGlsZDsgbGV0IHN4PTAsc3k9MCxveD0wLG95PTAsZHJhZz1mYWxzZTsKICAgIGhlYWQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIixlPT57ZHJhZz10cnVlO3N4PWUuY2xpZW50WDtzeT1lLmNsaWVudFk7Y29uc3Qgcj1wYW5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtveD1yLmxlZnQ7b3k9ci50b3A7fSk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIixlPT57IGlmKCFkcmFnKSByZXR1cm47IHBhbmVsLnN0eWxlLmxlZnQ9KG94K2UuY2xpZW50WC1zeCkrInB4IjsgcGFuZWwuc3R5bGUudG9wPShveStlLmNsaWVudFktc3kpKyJweCI7IHBhbmVsLnN0eWxlLnJpZ2h0PSJhdXRvIjsgcGFuZWwuc3R5bGUuYm90dG9tPSJhdXRvIjsgfSk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibW91c2V1cCIsKCk9PmRyYWc9ZmFsc2UpOwoKICAgIC8vIHJlZnMKICAgIGxvZ0VsICAgICA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoIiNncnZfbG9nIik7CiAgICBiYWRnZVRvayAgPSBwYW5lbC5xdWVyeVNlbGVjdG9yKCIjZ3J2X2JhZGdlX3RvayIpOwogICAgYmFkZ2VCYXNlID0gcGFuZWwucXVlcnlTZWxlY3RvcigiI2dydl9iYWRnZV9iYXNlIik7CiAgICBpblN0YXJ0ICAgPSBwYW5lbC5xdWVyeVNlbGVjdG9yKCIjZ3J2X3N0YXJ0Iik7CiAgICBpbkVuZCAgICAgPSBwYW5lbC5xdWVyeVNlbGVjdG9yKCIjZ3J2X2VuZCIpOwogICAgc2VsRmlsdGVyID0gcGFuZWwucXVlcnlTZWxlY3RvcigiI2dydl9maWx0ZXIiKTsKICAgIGJ0blJ1biAgICA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoIiNncnZfcnVuIik7CiAgICBidG5YTFNYICAgPSBwYW5lbC5xdWVyeVNlbGVjdG9yKCIjZ3J2X3hsc3giKTsKICAgIGJ0bkNvcHkgICA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoIiNncnZfY29weSIpOwogICAgYnRuQ29weUxvZz0gcGFuZWwucXVlcnlTZWxlY3RvcigiI2dydl9jb3B5X2xvZyIpOwoKICAgIGNoa0FkZHIgICA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoIiNncnZfYWRkcl9lbmFibGUiKTsKICAgIGFkZHJCb3ggICA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoIiNncnZfYWRkcl9ib3giKTsKICAgIHJhZEFwICAgICA9IGFkZHJCb3gucXVlcnlTZWxlY3RvcignaW5wdXRbdmFsdWU9ImFwcmVlbnNhbyJdJyk7CiAgICByYWRSbSAgICAgPSBhZGRyQm94LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3ZhbHVlPSJyZW1vY2FvIl0nKTsKICAgIHJhZEJvdGggICA9IGFkZHJCb3gucXVlcnlTZWxlY3RvcignaW5wdXRbdmFsdWU9ImFtYm9zIl0nKTsKCiAgICBjaGtQb2wgICAgPSBwYW5lbC5xdWVyeVNlbGVjdG9yKCIjZ3J2X3BvbF9lbmFibGUiKTsKICAgIHBvbEJveCAgICA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoIiNncnZfcG9sX2JveCIpOwogICAgY2hrUG9sT2ZpY2lhbCA9IHBvbEJveC5xdWVyeVNlbGVjdG9yKCIjZ3J2X3BvbF9vZmljaWFsIik7CiAgICBjaGtQb2xPYnMgICAgID0gcG9sQm94LnF1ZXJ5U2VsZWN0b3IoIiNncnZfcG9sX29icyIpOwoKICAgIC8vIHBvcHVsYSBmaWx0cm8gKHBhZHLDo28gZml4bzog4oCcTm8gcMOhdGlv4oCdKQogICAgZm9yIChjb25zdCBbdmFsLGxhYmVsXSBvZiBGSUxURVJfT1BUSU9OUyl7CiAgICAgIGNvbnN0IG9wdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsgb3B0LnZhbHVlPXZhbDsgb3B0LnRleHRDb250ZW50PWxhYmVsOwogICAgICBzZWxGaWx0ZXIuYXBwZW5kQ2hpbGQob3B0KTsKICAgIH0KICAgIHNlbEZpbHRlci52YWx1ZSA9ICIxIjsKCiAgICAvLyBldmVudG9zCiAgICBidG5SdW4ub25jbGljayAgPSBvblJ1bjsKICAgIGJ0blhMU1gub25jbGljayA9IGRvd25sb2FkWExTWDsKICAgIGJ0bkNvcHkub25jbGljayA9IGNvcHlUU1Y7CiAgICBidG5Db3B5TG9nLm9uY2xpY2sgPSAoKT0+bmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQobG9nRWwudmFsdWUpLnRoZW4oKCk9PmxvZygiTG9nIGNvcGlhZG8uIiksKCk9PmxvZygiRmFsaGEgYW8gY29waWFyIGxvZy4iKSk7CgogICAgY2hrQWRkci5hZGRFdmVudExpc3RlbmVyKCJjaGFuZ2UiLCAoKT0+eyBhZGRyQm94LnN0eWxlLmRpc3BsYXkgPSBjaGtBZGRyLmNoZWNrZWQgPyAiYmxvY2siIDogIm5vbmUiOyB9KTsKICAgIGNoa1BvbC5hZGRFdmVudExpc3RlbmVyKCJjaGFuZ2UiLCAgKCk9PnsgcG9sQm94LnN0eWxlLmRpc3BsYXkgID0gY2hrUG9sLmNoZWNrZWQgID8gImJsb2NrIiA6ICJub25lIjsgfSk7CgogICAgdXBkYXRlQmFkZ2VzKCk7CiAgICBzZXRUaW1lb3V0KHRyeVBlcmYsIDI1MCk7CiAgfQoKICAvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IENBQkXDh0FMSE8gRElOw4JNSUNPID09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICBmdW5jdGlvbiBidWlsZEhlYWRlcihpbmNsdWRlQWRkciwgb3JpZ2luLCBwb2xPbiwgcG9sT2YsIHBvbE9icyl7CiAgICBjb25zdCBiYXNlID0gWyJHUlYiLCJQbGFjYSBPcmlnaW5hbCIsIlBsYWNhIE9zdGVudGFkYSIsIkNoYXNzaSIsIkRhdGEgZGEgQXByZWVuc8OjbyIsIkRhdGEgZGEgUmV0aXJhZGEiLCJNYXJjYS9Nb2RlbG8iLCJQw6F0aW8iLCJWYWdhIiwiTsK6IGRhIENoYXZlIiwiU2l0dWHDp8OjbyJdOwogICAgY29uc3Qgb3V0ID0gYmFzZS5zbGljZSgpOwogICAgaWYgKGluY2x1ZGVBZGRyKXsKICAgICAgY29uc3QgYXAgPSBbIkxvZ3JhZG91cm8gKGFwcmVlbnPDo28pIiwiQmFpcnJvIChhcHJlZW5zw6NvKSIsIkNpZGFkZSAoYXByZWVuc8OjbykiLCJVRiAoYXByZWVuc8OjbykiLCJDb21wbGVtZW50byAoYXByZWVuc8OjbykiXTsKICAgICAgY29uc3Qgcm0gPSBbIkxvZ3JhZG91cm8gKHJlbW/Dp8OjbykiLCJCYWlycm8gKHJlbW/Dp8OjbykiLCJDaWRhZGUgKHJlbW/Dp8OjbykiLCJVRiAocmVtb8Onw6NvKSIsIkNvbXBsZW1lbnRvIChyZW1vw6fDo28pIl07CiAgICAgIGlmIChvcmlnaW49PT0iYXByZWVuc2FvIikgb3V0LnB1c2goLi4uYXApOwogICAgICBlbHNlIGlmIChvcmlnaW49PT0icmVtb2NhbyIpIG91dC5wdXNoKC4uLnJtKTsKICAgICAgZWxzZSBvdXQucHVzaCguLi5hcCwgLi4ucm0pOwogICAgfQogICAgaWYgKHBvbE9uKXsKICAgICAgaWYgKHBvbE9mKXsgb3V0LnB1c2goIlBvbGljaWFsIGFwcmVlbnNvciIsIk1hdHLDrWN1bGEiKTsgfQogICAgICBpZiAocG9sT2JzKXsgb3V0LnB1c2goIlBvbGljaWFsIGFwcmVlbnNvciAob2JzZXJ2YcOnw6NvKSIsIk1hdHLDrWN1bGEgKG9ic2VydmHDp8OjbykiKTsgfQogICAgfQogICAgcmV0dXJuIG91dDsKICB9CiAgZnVuY3Rpb24gYXBwZW5kQWRkcmVzc0lmTmVlZGVkKHJvdywgaXRlbSwgaW5jbHVkZUFkZHIsIG9yaWdpbil7CiAgICBpZiAoIWluY2x1ZGVBZGRyKSByZXR1cm4gcm93OwogICAgaWYgKG9yaWdpbj09PSJhcHJlZW5zYW8iKSByZXR1cm4gcm93LmNvbmNhdChwaWNrRW5kZXJlY29Gcm9tTGlzdChpdGVtLCJhcHJlZW5zYW8iKSk7CiAgICBpZiAob3JpZ2luPT09InJlbW9jYW8iKSAgIHJldHVybiByb3cuY29uY2F0KHBpY2tFbmRlcmVjb0Zyb21MaXN0KGl0ZW0sInJlbW9jYW8iKSk7CiAgICByZXR1cm4gcm93LmNvbmNhdChwaWNrRW5kZXJlY29Gcm9tTGlzdChpdGVtLCJhcHJlZW5zYW8iKSwgcGlja0VuZGVyZWNvRnJvbUxpc3QoaXRlbSwicmVtb2NhbyIpKTsKICB9CgogIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBDT1JFID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwogIGFzeW5jIGZ1bmN0aW9uIG9uUnVuKCl7CiAgICBpZiAoIVNUQVRFLmF1dGhIZWFkZXIpeyBsb2coIkVSUk86IHRva2VuIG7Do28gY2FwdHVyYWRvLiIpOyByZXR1cm47IH0KICAgIGlmICghU1RBVEUubGlzdEJhc2UpeyB0cnlQZXJmKCk7IH0KICAgIGlmICghU1RBVEUubGlzdEJhc2UpeyBsb2coIkVSUk86IGJhc2UgZGEgbGlzdGEgbsOjbyBkZXRlY3RhZGEuIE5hdmVndWUgMSBww6FnaW5hIG91IHNlbGVjaW9uZSAxMDAgcG9yIHDDoWdpbmEuIik7IHJldHVybjsgfQoKICAgIGNvbnN0IHN0YXJ0ID0gTWF0aC5tYXgoMSwgcGFyc2VJbnQoaW5TdGFydC52YWx1ZXx8IjEiLDEwKSk7CiAgICBjb25zdCBlbmQgICA9IE1hdGgubWF4KDAsIHBhcnNlSW50KGluRW5kLnZhbHVlfHwiNSIsMTApKTsKICAgIGNvbnN0IGZpbHRlclZhbHVlID0gc2VsRmlsdGVyLnZhbHVlIHx8ICIxIjsgLy8gZGVmYXVsdCBObyBww6F0aW8KCiAgICBjb25zdCBpbmNsdWRlQWRkciA9ICEhY2hrQWRkci5jaGVja2VkOwogICAgY29uc3Qgb3JpZ2luID0gaW5jbHVkZUFkZHIgPyAocmFkQXAuY2hlY2tlZCA/ICJhcHJlZW5zYW8iIDogKHJhZFJtLmNoZWNrZWQgPyAicmVtb2NhbyIgOiAiYW1ib3MiKSkgOiAiYXByZWVuc2FvIjsKCiAgICBjb25zdCBpbmNsdWRlUG9sID0gISFjaGtQb2wuY2hlY2tlZDsKICAgIGNvbnN0IHBvbE9mID0gaW5jbHVkZVBvbCAmJiAhIWNoa1BvbE9maWNpYWwuY2hlY2tlZDsKICAgIGNvbnN0IHBvbE9icyA9IGluY2x1ZGVQb2wgJiYgISFjaGtQb2xPYnMuY2hlY2tlZDsKCiAgICBjb25zdCBmaWx0ZXJMYWJlbCA9IEZJTFRFUl9PUFRJT05TLmZpbmQoZj0+ZlswXT09PWZpbHRlclZhbHVlKT8uWzFdIHx8IGZpbHRlclZhbHVlOwogICAgY29uc3QgYWRkckxhYmVsID0gaW5jbHVkZUFkZHIgPyBvcmlnaW4gOiAibsOjbyI7CiAgICBjb25zdCBwb2xMYWJlbCAgPSBpbmNsdWRlUG9sID8gKGBvZmljaWFpcz0ke3BvbE9mPyJzaW0iOiJuw6NvIn07IG9icz0ke3BvbE9icz8ic2ltIjoibsOjbyJ9YCkgOiAibsOjbyI7CiAgICBsb2coYEluw61jaW86ICR7c3RhcnR9IHwgRmltOiAke2VuZHx8ImF0w6kgemVyYXIifSB8IEZpbHRybyAoc2NyaXB0L0FQSSk6ICR7ZmlsdGVyTGFiZWx9IHwgRW5kZXJlw6dvOiAke2FkZHJMYWJlbH0gfCBQb2xpY2lhbDogJHtwb2xMYWJlbH1gKTsKICAgIGxvZyhgQmFzZSB1c2FkYTogJHtTVEFURS5saXN0QmFzZX1gKTsKICAgIGlmIChlbmQ+MCkgbG9nKGBNZXRhOiAke2VuZCoxMDB9IG1hbnRpZG9zIHBlbG8gZmlsdHJvLmApOwoKICAgIGNvbnN0IGhlYWRlciA9IGJ1aWxkSGVhZGVyKGluY2x1ZGVBZGRyLCBvcmlnaW4sIGluY2x1ZGVQb2wsIHBvbE9mLCBwb2xPYnMpOwogICAgY29uc3QgYW9hID0gW2hlYWRlcl07CgogICAgY29uc3QgdGFyZ2V0S2VwdCA9IGVuZCA+IDAgPyAoZW5kICogMTAwKSA6IG51bGw7CgogICAgbGV0IHBhZ2U9c3RhcnQsdG90YWw9MCxrZXB0PTAsZW1wdHk9MDsKICAgIGNvbnN0IHRhc2tzID0gW107IC8vIGZpbGEgZGUgZGV0YWxoZXMg4oaSIHtyb3dJbmRleCwgaXRlbX0KCiAgICB3aGlsZSh0cnVlKXsKICAgICAgaWYgKHRhcmdldEtlcHQgIT0gbnVsbCAmJiBrZXB0ID49IHRhcmdldEtlcHQpIGJyZWFrOyAgIC8vIGrDoSBhdGluZ2l1IE7DlzEwMCBtYW50aWRvcwoKICAgICAgbG9nKGDihpIgUMOhZ2luYSAke3BhZ2V94oCmYCk7CiAgICAgIGxldCBpdGVtcz1bXTsKICAgICAgdHJ5eyBpdGVtcyA9IGF3YWl0IGdldExpc3RQYWdlKFNUQVRFLmxpc3RCYXNlLCBwYWdlLCBmaWx0ZXJWYWx1ZSk7IH0KICAgICAgY2F0Y2goZSl7IGxvZyhgRVJSTyBBUEk6ICR7ZSAmJiBlLm1lc3NhZ2UgfHwgZX1gKTsgYnJlYWs7IH0KCiAgICAgIGlmICghaXRlbXMgfHwgaXRlbXMubGVuZ3RoPT09MCl7CiAgICAgICAgbG9nKGBQw6FnaW5hICR7cGFnZX06IDAgaXRlbnMuYCk7CiAgICAgICAgZW1wdHkrKzsKICAgICAgICAvLyBGaW09MDogdmFycmUgYXTDqSDigJx6ZXJhcuKAnSAocHJpbWVpcmEgdmF6aWEpLgogICAgICAgIC8vIEZpbT4wOiBhY2Fib3UgYSBsaXN0YSBhbnRlcyBkYSBtZXRhIOKAlCBwYXJhbW9zLgogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBlbXB0eT0wOwogICAgICBsZXQga2VwdFRoaXNQYWdlID0gMDsKICAgICAgZm9yIChjb25zdCBpdCBvZiBpdGVtcyl7CiAgICAgICAgLy8gRGVmZXNhOiBtZXNtbyBmaWx0cmFuZG8gbmEgQVBJLCBtYW50ZW1vcyBvIGZpbHRybyBsb2NhbAogICAgICAgIGNvbnN0IGNvZGUgPSBOdW1iZXIoaXQ/LnN0YXR1cyk7CiAgICAgICAgaWYgKCFwYXNzRmlsdGVyKGNvZGUsIGZpbHRlclZhbHVlKSkgY29udGludWU7CgogICAgICAgIGNvbnN0IGJhc2UgPSBiYXNlUm93KGl0KTsKICAgICAgICBjb25zdCB3aXRoQWRkciA9IGFwcGVuZEFkZHJlc3NJZk5lZWRlZChiYXNlLCBpdCwgaW5jbHVkZUFkZHIsIG9yaWdpbik7CgogICAgICAgIGNvbnN0IHJvd0luZGV4ID0gYW9hLmxlbmd0aDsKICAgICAgICBhb2EucHVzaCh3aXRoQWRkcik7CiAgICAgICAga2VwdCsrOyBrZXB0VGhpc1BhZ2UrKzsKCiAgICAgICAgaWYgKGluY2x1ZGVQb2wgJiYgKHBvbE9mIHx8IHBvbE9icykpewogICAgICAgICAgdGFza3MucHVzaCh7cm93SW5kZXgsIGl0ZW06IGl0fSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGFyZ2V0S2VwdCAhPSBudWxsICYmIGtlcHQgPj0gdGFyZ2V0S2VwdCkgYnJlYWs7CiAgICAgIH0KICAgICAgdG90YWwgKz0gaXRlbXMubGVuZ3RoOwogICAgICBsb2coYOKckyAke2l0ZW1zLmxlbmd0aH0gaXRlbnMgcmVjZWJpZG9zOyBtYW50aWRvcyBuZXN0YSBww6FnaW5hOiAke2tlcHRUaGlzUGFnZX07IG1hbnRpZG9zIGFjdW11bGFkb3M6ICR7a2VwdH0uYCk7CgogICAgICBpZiAodGFyZ2V0S2VwdCAhPSBudWxsICYmIGtlcHQgPj0gdGFyZ2V0S2VwdCkgYnJlYWs7CiAgICAgIHBhZ2UrKzsgYXdhaXQgc2xlZXAoMzApOwogICAgfQoKICAgIGlmIChpbmNsdWRlUG9sICYmIChwb2xPZiB8fCBwb2xPYnMpICYmIHRhc2tzLmxlbmd0aD4wKXsKICAgICAgbG9nKGBbcG9saWNpYWxdIGluaWNpYW5kbyBkZXRhbGhlIHBhcmEgJHt0YXNrcy5sZW5ndGh9IGxpbmhhKHMpICgyIHdvcmtlcnMpYCk7CiAgICAgIGF3YWl0IHJ1bkRldGFpbFdvcmtlcnModGFza3MsIGFvYSwge3BvbE9mLCBwb2xPYnN9KTsKICAgIH0KCiAgICBTVEFURS5yb3dzQU9BID0gYW9hOwogICAgYnRuWExTWC5kaXNhYmxlZCA9IGZhbHNlOwogICAgYnRuQ29weS5kaXNhYmxlZCA9IGZhbHNlOwogICAgbG9nKGBDb25jbHXDrWRvLiBJdGVucyByZWNlYmlkb3MgKGJydXRvcyk6ICR7dG90YWx9LiBMaW5oYXMgZXhwb3J0w6F2ZWlzIChww7NzLWZpbHRybyk6ICR7YW9hLmxlbmd0aC0xfS5gKTsKICB9CgogIC8vIDIgd29ya2VycyBmaXhvcywgY29tIHJldHJpZXMgbGV2ZXMgZSBiYWNrb2ZmCiAgYXN5bmMgZnVuY3Rpb24gcnVuRGV0YWlsV29ya2Vycyh0YXNrcywgYW9hLCBvcHRzKXsKICAgIGNvbnN0IHtwb2xPZiwgcG9sT2JzfSA9IG9wdHM7CiAgICBsZXQgaWR4ID0gMDsKICAgIGNvbnN0IG5leHQgPSAoKT0+IChpZHggPCB0YXNrcy5sZW5ndGgpID8gdGFza3NbaWR4KytdIDogbnVsbDsKCiAgICBhc3luYyBmdW5jdGlvbiBmZXRjaFdpdGhSZXRyeShqb2IpewogICAgICBjb25zdCBNQVggPSAzOwogICAgICBmb3IgKGxldCBhPTE7IGE8PU1BWDsgYSsrKXsKICAgICAgICB0cnkgeyByZXR1cm4gYXdhaXQgZmV0Y2hEZXRhbGhlQnlJZE9yTnVtZXJvKGpvYi5pdGVtKTsgfQogICAgICAgIGNhdGNoKGUpewogICAgICAgICAgaWYgKGE9PT1NQVgpIHRocm93IGU7CiAgICAgICAgICBjb25zdCB3YWl0ID0gNDAwICogYTsgLy8gMC40cywgMC44cywgMS4ycwogICAgICAgICAgYXdhaXQgc2xlZXAod2FpdCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gd29ya2VyKGlkKXsKICAgICAgd2hpbGUodHJ1ZSl7CiAgICAgICAgY29uc3Qgam9iID0gbmV4dCgpOwogICAgICAgIGlmICgham9iKSBicmVhazsKICAgICAgICB0cnl7CiAgICAgICAgICBjb25zdCBkZXQgPSBhd2FpdCBmZXRjaFdpdGhSZXRyeShqb2IpOwogICAgICAgICAgY29uc3QgY29scyA9IFtdOwogICAgICAgICAgaWYgKHBvbE9mKXsKICAgICAgICAgICAgY29uc3Qge25vbWUsIG1hdH0gPSBnZXRQb2xpY2lhbE9maWNpYWxGcm9tRGV0YWxoZShkZXQpOwogICAgICAgICAgICBjb2xzLnB1c2goc2FmZShub21lKSwgc2FmZShtYXQpKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChwb2xPYnMpewogICAgICAgICAgICBjb25zdCBvYnMgPSBkZXQ/Lm9ic2VydmFjb2VzIHx8IGRldD8ub2JzZXJ2YWNhbyB8fCBkZXQ/Lm9ic2VydmFjb2VzVmVpY3VsbyB8fCAiIjsKICAgICAgICAgICAgY29uc3Qge25vbWVPYnMsIG1hdE9ic30gPSBwYXJzZVBvbGljaWFsRnJvbU9ic2VydmFjYW8ob2JzKTsKICAgICAgICAgICAgY29scy5wdXNoKHNhZmUobm9tZU9icyksIHNhZmUobWF0T2JzKSk7CiAgICAgICAgICB9CiAgICAgICAgICBhb2Fbam9iLnJvd0luZGV4XSA9IGFvYVtqb2Iucm93SW5kZXhdLmNvbmNhdChjb2xzKTsKICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgbG9nKGBbcG9saWNpYWxdIGZhbGhhICgke2UgJiYgZS5tZXNzYWdlIHx8IGV9KSBlbSBHUlYgJHtqb2IuaXRlbT8ubnVtZXJvIHx8ICI/In1gKTsKICAgICAgICAgIGNvbnN0IGNvbHMgPSBbXTsKICAgICAgICAgIGlmIChwb2xPZikgY29scy5wdXNoKCItLS0tLSIsIi0tLS0tIik7CiAgICAgICAgICBpZiAocG9sT2JzKSBjb2xzLnB1c2goIi0tLS0tIiwiLS0tLS0iKTsKICAgICAgICAgIGFvYVtqb2Iucm93SW5kZXhdID0gYW9hW2pvYi5yb3dJbmRleF0uY29uY2F0KGNvbHMpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgYXdhaXQgUHJvbWlzZS5hbGwoW3dvcmtlcigxKSwgd29ya2VyKDIpXSk7CiAgfQoKICAvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBFWFBPUlRTID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCiAgZnVuY3Rpb24gZG93bmxvYWRYTFNYKCl7CiAgICBpZighU1RBVEUucm93c0FPQSl7IGxvZygiTmFkYSBwYXJhIGV4cG9ydGFyLiIpOyByZXR1cm47IH0KICAgIGlmKCEod2luZG93LlhMU1ggJiYgWExTWC51dGlscykpeyBsb2coIkFndWFyZGUgbyBtw7NkdWxvIFhMU1ggY2FycmVnYXIgZSB0ZW50ZSBkZSBub3ZvLiIpOyByZXR1cm47IH0KICAgIGNvbnN0IHdzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoU1RBVEUucm93c0FPQSk7CiAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsKICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzLCAiR1JWIik7CiAgICBjb25zdCB3Ym91dCA9IFhMU1gud3JpdGUod2IsIHtib29rVHlwZToieGxzeCIsIHR5cGU6ImFycmF5In0pOwogICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFt3Ym91dF0sIHt0eXBlOiJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0ifSk7CiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgIGEuZG93bmxvYWQgPSBgZ3J2X2xpc3RhXyR7dHMoKX0ueGxzeGA7CiAgICBhLmNsaWNrKCk7IHNldFRpbWVvdXQoKCk9PlVSTC5yZXZva2VPYmplY3RVUkwoYS5ocmVmKSwgNDAwKTsKICB9CgogIGFzeW5jIGZ1bmN0aW9uIGNvcHlUU1YoKXsKICAgIGlmKCFTVEFURS5yb3dzQU9BKXsgbG9nKCJOYWRhIHBhcmEgY29waWFyLiIpOyByZXR1cm47IH0KICAgIGNvbnN0IHNhbml0aXplRm9yVFNWID0gKHYpID0+IHsKICAgICAgaWYgKHYgPT0gbnVsbCkgcmV0dXJuICIiOwogICAgICByZXR1cm4gU3RyaW5nKHYpCiAgICAgICAgLnJlcGxhY2UoL1xyP1xuL2csICIgIikgICAvLyBcbiDihpIgZXNwYcOnbwogICAgICAgIC5yZXBsYWNlKC9cdC9nLCAiICIpICAgICAgLy8gXHQg4oaSIGVzcGHDp28KICAgICAgICAucmVwbGFjZSgvXHUwMEEwL2csICIgIikgIC8vIE5CU1Ag4oaSIGVzcGHDp28KICAgICAgICAucmVwbGFjZSgvXHN7Mix9L2csICIgIikgIC8vIGNvbXBhY3RhCiAgICAgICAgLnRyaW0oKTsKICAgIH07CiAgICBjb25zdCB0c3YgPSBTVEFURS5yb3dzQU9BLm1hcChyb3cgPT4gcm93Lm1hcChzYW5pdGl6ZUZvclRTVikuam9pbigiXHQiKSkuam9pbigiXHJcbiIpOwogICAgdHJ5IHsKICAgICAgaWYgKG5hdmlnYXRvci5jbGlwYm9hcmQgJiYgd2luZG93LkNsaXBib2FyZEl0ZW0pIHsKICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3Rzdl0sIHsgdHlwZTogInRleHQvdGFiLXNlcGFyYXRlZC12YWx1ZXMiIH0pOwogICAgICAgIGNvbnN0IGl0ZW0gPSBuZXcgQ2xpcGJvYXJkSXRlbSh7ICJ0ZXh0L3RhYi1zZXBhcmF0ZWQtdmFsdWVzIjogYmxvYiwgInRleHQvcGxhaW4iOiBibG9iIH0pOwogICAgICAgIGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGUoW2l0ZW1dKTsKICAgICAgICBsb2coIkNvcGlhZG8gKFRTVikuIENvbGUgbm8gR29vZ2xlIFNoZWV0cy9FeGNlbC4iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0gY2F0Y2gge30KICAgIHRyeSB7CiAgICAgIGlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkICYmIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KSB7CiAgICAgICAgYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodHN2KTsKICAgICAgICBsb2coIkNvcGlhZG8gKFRTVikuIENvbGUgbm8gR29vZ2xlIFNoZWV0cy9FeGNlbC4iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0gY2F0Y2gge30KICAgIHRyeSB7CiAgICAgIGNvbnN0IHRhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRleHRhcmVhIik7CiAgICAgIHRhLnN0eWxlLnBvc2l0aW9uPSJmaXhlZCI7IHRhLnN0eWxlLmxlZnQ9Ii05OTk5cHgiOyB0YS52YWx1ZT10c3Y7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGEpOwogICAgICB0YS5mb2N1cygpOyB0YS5zZWxlY3QoKTsKICAgICAgY29uc3Qgb2s9ZG9jdW1lbnQuZXhlY0NvbW1hbmQoImNvcHkiKTsKICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0YSk7CiAgICAgIGxvZyhvayA/ICJDb3BpYWRvIChUU1YpLiBDb2xlIG5vIEdvb2dsZSBTaGVldHMvRXhjZWwuIgogICAgICAgICAgICAgOiAiRmFsaGEgYW8gY29waWFyLiBTZWxlY2lvbmUgZSBjb3BpZSBtYW51YWxtZW50ZS4iKTsKICAgIH0gY2F0Y2ggewogICAgICBsb2coIkZhbGhhIGFvIGNvcGlhci4gU2VsZWNpb25lIGUgY29waWUgbWFudWFsbWVudGUuIik7CiAgICB9CiAgfQoKICAvLyBTaGVldEpTIHBhcmEgWExTWAogIGNvbnN0IHM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CiAgcy5zcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3hsc3gvMC4xOC41L3hsc3guZnVsbC5taW4uanMiOwogIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQocyk7CgogIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBCT09UID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwogIGZ1bmN0aW9uIGJvb3QoKXsKICAgIGlmIChkb2N1bWVudC5ib2R5KSBidWlsZFBhbmVsKCk7CiAgICBlbHNlIHsKICAgICAgY29uc3QgbW89bmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCk9PnsgaWYoZG9jdW1lbnQuYm9keSl7IG1vLmRpc2Nvbm5lY3QoKTsgYnVpbGRQYW5lbCgpOyB9IH0pOwogICAgICBtby5vYnNlcnZlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudHx8ZG9jdW1lbnQsIHtjaGlsZExpc3Q6dHJ1ZSxzdWJ0cmVlOnRydWV9KTsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCAoKT0+eyBpZighcGFuZWwpIGJ1aWxkUGFuZWwoKTsgfSwge29uY2U6dHJ1ZX0pOwogICAgfQogIH0KICBib290KCk7Cn0pKCk7";
  const bin = (typeof atob === "function") ? atob(b) : ((typeof Buffer !== "undefined") ? Buffer.from(b,"base64").toString("binary") : b);
  let src;
  try { src = new TextDecoder("utf-8").decode(Uint8Array.from(bin, c => c.charCodeAt(0))); }
  catch(e) { try { src = decodeURIComponent(escape(bin)); } catch(_) { src = bin; } }
  (0, eval)(src);
})();
